<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>عطور الأناقة – المتجر الفاخر</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
@import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;700;900&display=swap');

:root{
  --gold:#d4af37;--gold-dim:#b59020;--black:#0f0f0f;
  --dark:#1a1a1a;--light:#2c2c2c;--white:#f0f0f0;
  --red:#e74c3c;
}

*{box-sizing:border-box;margin:0;padding:0;font-family:'Tajawal',sans-serif}
body{background:var(--black);color:var(--white);direction:rtl;padding-bottom:80px}

header{text-align:center;padding:30px;border-bottom:1px solid #333}
header h1{color:var(--gold);font-size:2.5rem;font-weight:900}
header p{color:#aaa}

.container{max-width:900px;margin:auto;padding:15px}
.section{background:var(--dark);border-radius:15px;padding:20px;margin-bottom:20px;border:1px solid #333}

h2,h3{color:var(--gold);margin-bottom:15px;border-bottom:2px solid var(--gold-dim);display:inline-block}

input,select,textarea,button{
  width:100%;padding:12px;margin:6px 0;border-radius:8px;
  border:1px solid #444;background:var(--light);color:#fff
}
button{background:var(--gold);color:#000;font-weight:bold;cursor:pointer}
button:hover{background:var(--gold-dim)}
button.secondary{background:#444;color:#fff}
button.danger{background:var(--red);color:#fff}

.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(140px,1fr));gap:10px}

.card{
  background:var(--light);padding:10px;border-radius:10px;
  text-align:center;border:1px solid #333;cursor:pointer
}
.card:hover{border-color:var(--gold)}
.card img{
  width:100%;height:130px;object-fit:cover;
  aspect-ratio:1/1;border-radius:8px
}
.price{color:var(--gold);font-weight:bold}

.hidden{display:none}

.admin-float{
  position:fixed;bottom:20px;left:20px;
  width:50px;height:50px;background:var(--gold);
  border-radius:50%;display:flex;align-items:center;justify-content:center;
  cursor:pointer;font-size:1.5rem;z-index:999
}

.admin-overlay{
  display:none;position:fixed;top:0;left:0;width:100%;height:100%;
  background:rgba(0,0,0,.95);z-index:1000;overflow:auto
}
.admin-box{
  max-width:900px;margin:20px auto;background:#151515;
  padding:20px;border-radius:12px;border:1px solid var(--gold)
}

.admin-item{
  display:flex;gap:10px;align-items:center;
  background:#222;padding:10px;margin-bottom:5px;border-radius:5px
}
.admin-item img{width:40px;height:40px;border-radius:5px;object-fit:cover}
</style>
</head>

<body>

<header>
  <h1>عطور الأناقة</h1>
  <p>أفخم العطور بلمستك الخاصة</p>
</header>

<div class="container">

<div class="section">
<h2>الزجاجات</h2>
<div id="bottles" class="grid"></div>
</div>

<div class="section hidden" id="perfumeSection">
<h2>العطور</h2>
<div id="perfumes" class="grid"></div>
</div>

</div>

<div class="admin-float" onclick="openAdmin()">⚙️</div>

<div class="admin-overlay" id="admin">
<div class="admin-box">
<span onclick="admin.style.display='none'" style="float:left;font-size:30px;cursor:pointer;color:red">&times;</span>

<h2>لوحة التحكم</h2>

<input id="name" placeholder="اسم المنتج">
<input id="price" type="number" placeholder="السعر">
<input id="capacity" type="number" placeholder="السعة (للزجاجات فقط)">

<label>رفع صورة (Cloudinary):</label>
<input type="file" id="imgInput" accept="image/*">

<img id="preview" style="width:70px;height:70px;display:none;border-radius:8px">

<button onclick="save()">حفظ</button>

<h3>المنتجات</h3>
<div id="adminList"></div>

</div>
</div>

<script>
/* ====== Cloudinary Config (مجاني) ====== */
const CLOUD_NAME = "dtkgml8yg";
const UPLOAD_PRESET = "products";

/* ====== Admin ====== */
const ADMIN_PASS = "1234";

/* ====== Data ====== */
let bottles = JSON.parse(localStorage.getItem("bottles")) || [];
let perfumes = JSON.parse(localStorage.getItem("perfumes")) || [];
let currentBottle = null;
let imgData = "";

/* ====== Upload Image ====== */
imgInput.onchange = async e => {
  const file = e.target.files[0];
  if (!file) return;

  const formData = new FormData();
  formData.append("file", file);
  formData.append("upload_preset", UPLOAD_PRESET);

  preview.style.display = "block";
  preview.src = "https://i.imgur.com/llF5iyg.gif";

  const res = await fetch(
    `https://api.cloudinary.com/v1_1/${CLOUD_NAME}/image/upload`,
    { method: "POST", body: formData }
  );

  const data = await res.json();
  imgData = data.secure_url;
  preview.src = imgData;
};

/* ====== Save Product ====== */
function save(){
  const nameVal = name.value.trim();
  const priceVal = price.value;
  const capVal = capacity.value;

  if(!nameVal || !priceVal) return alert("الاسم والسعر مطلوبان");

  const product = {
    name: nameVal,
    price: priceVal,
    img: imgData
  };

  if(capVal){
    product.capacity = capVal;
    bottles.push(product);
    localStorage.setItem("bottles", JSON.stringify(bottles));
    renderBottles();
  } else {
    perfumes.push(product);
    localStorage.setItem("perfumes", JSON.stringify(perfumes));
  }

  alert("تم الحفظ بنجاح ✅");
  imgData="";
  preview.style.display="none";
  name.value=price.value=capacity.value="";
  renderAdmin();
}

/* ====== Render ====== */
function renderBottles(){
  bottlesDiv.innerHTML="";
  bottles.forEach((b,i)=>{
    bottlesDiv.innerHTML+=`
    <div class="card" onclick="selectBottle(${i})">
      <img src="${b.img}" onerror="this.src='https://via.placeholder.com/150'">
      <h4>${b.name}</h4>
      <div class="price">${b.capacity} مل</div>
    </div>`;
  });
}

function selectBottle(i){
  currentBottle=i;
  perfumeSection.classList.remove("hidden");
  renderPerfumes();
}

function renderPerfumes(){
  perfumesDiv.innerHTML="";
  perfumes.forEach(p=>{
    perfumesDiv.innerHTML+=`
    <div class="card">
      <img src="${p.img}" onerror="this.src='https://via.placeholder.com/150'">
      <h4>${p.name}</h4>
      <div class="price">${p.price} دج</div>
    </div>`;
  });
}

/* ====== Admin ====== */
function openAdmin(){
  const p = prompt("كلمة المرور");
  if(p===ADMIN_PASS){
    admin.style.display="block";
    renderAdmin();
  }
}

function renderAdmin(){
  adminList.innerHTML="";
  [...bottles,...perfumes].forEach(i=>{
    adminList.innerHTML+=`
    <div class="admin-item">
      <img src="${i.img}" onerror="this.src='https://via.placeholder.com/50'">
      <strong>${i.name}</strong>
    </div>`;
  });
}

/* Init */
renderBottles();
</script>

</body>
</html>
